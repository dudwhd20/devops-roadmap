# AWS EC2 심화 이론: EBS, 인스턴스 수명주기 등

---

## ✅ 1. EC2 인스턴스 수명주기 (Lifecycle)

EC2 인스턴스는 다음과 같은 상태(State)를 거칩니다:

| 상태          | 설명                                  |
| :------------ | :------------------------------------ |
| pending       | 생성 중 (Launch 요청 후)              |
| running       | 정상적으로 실행 중                    |
| stopping      | 정지 중 (stop 명령 실행됨)            |
| stopped       | 일시 정지 상태 (요금 X, EBS는 요금 O) |
| shutting-down | 종료 중 (terminate 요청됨)            |
| terminated    | 완전히 삭제된 상태 (복구 불가)        |

> 💡 `stopped` 상태에서는 EBS 볼륨은 유지되며, 재시작 시 데이터가 보존됩니다.

---

## ✅ 2. EBS (Elastic Block Store) 상세 옵션

EC2의 디스크는 EBS를 통해 연결되며, 다음과 같은 옵션이 있습니다:

### 📁 EBS 볼륨 타입

| 타입      | 설명                       | 사용 예시                   |
| :-------- | :------------------------- | :-------------------------- |
| gp3       | 범용 SSD (신규 기본값)     | 일반 서버, 웹앱             |
| gp2       | 이전 세대 범용 SSD         | 여전히 사용됨               |
| io2 / io1 | 고성능 SSD (지연시간 낮음) | 데이터베이스, 고IO 작업     |
| st1       | 처리량 최적화 HDD          | 대용량 로그, 빅데이터       |
| sc1       | 콜드 HDD                   | 백업, 사용 빈도 낮은 데이터 |

### 🔒 EBS 설정 옵션

- **삭제 시 볼륨 유지 여부**: EC2 종료 시 EBS를 유지할지 설정 가능
- **스냅샷**: 볼륨 백업 이미지. 다른 리전에 복제도 가능
- **암호화**: AWS KMS를 통해 볼륨 자동 암호화 가능

---

## ✅ 3. EC2 상태 점검 (Status Check)

| 점검 종류             | 설명                                           |
| :-------------------- | :--------------------------------------------- |
| System Status Check   | AWS 인프라 자체 문제 여부 (HW, NW 등)          |
| Instance Status Check | 인스턴스 내부 문제 (커널 패닉, 디스크 오류 등) |

> 💡 두 가지 체크 모두 통과해야 인스턴스가 정상적으로 작동한다고 판단

---

## ✅ 4. EC2 인스턴스 메타데이터 & 유저 데이터

### 🧾 인스턴스 메타데이터

- EC2 내부에서 자체 정보를 조회 가능
- 예: 퍼블릭 IP, IAM Role, 호스트 이름 등

```bash
curl http://169.254.169.254/latest/meta-data/
```

### ⚙️ 유저 데이터 (User Data)

- 인스턴스 생성 시 최초 1회 실행할 셸 스크립트 or 클라우드-이니트
- 서버 자동 설정 스크립트에 활용 가능

```bash
#!/bin/bash
sudo yum update -y
sudo yum install -y nginx
sudo systemctl start nginx
```

---

## ✅ 5. 고급 네트워킹

| 구성 요소                       | 설명                                                                                                          |
| :------------------------------ | :------------------------------------------------------------------------------------------------------------ |
| ENI (Elastic Network Interface) | 추가 네트워크 인터페이스 장착 가능 (멀티 IP 구성 등)                                                          |
| Placement Group                 | 고성능 워크로드를 위한 물리적 배치 옵션<br>- Cluster (근접 배치), Spread (분산 배치), Partition (파티션 배치) |
| Dedicated Host                  | 물리 서버 단독 점유, 라이선스 BYOL(Bring Your Own License) 시 사용                                            |

---

## ✅ 6. EC2 비용 최적화 전략

- 예약 인스턴스 + 스팟 혼용 전략
- Auto Scaling Group을 통한 자동 관리
- CloudWatch + Lambda 조합으로 비활성 리소스 자동 종료

---

# ✨ 요약 정리

- 인스턴스는 상태별로 라이프사이클을 가지며, `stopped` 상태에서는 비용이 절감됨
- EBS는 다양한 유형이 존재하며, 암호화 및 스냅샷 기능으로 확장 가능
- 상태 점검, 유저데이터, 메타데이터를 활용해 자동화와 모니터링 가능
- 네트워크, 물리 자원 선택을 통해 고성능 설계도 가능

---
